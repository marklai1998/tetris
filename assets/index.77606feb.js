var x=Object.defineProperty;var y=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var m=(t,e,n)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e)=>{for(var n in e||(e={}))I.call(e,n)&&m(t,n,e[n]);if(y)for(var n of y(e))_.call(e,n)&&m(t,n,e[n]);return t};const D=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}};D();const T=(t,e)=>{t.innerHTML="",e.forEach((n,l)=>{const o=document.createElement("div");o.className="grid-row",o.id="R"+l,n.forEach((c,s)=>{const a=document.createElement("cell");a.textContent=String(c),a.id="R"+l+"C"+s,a.className=`grid-cell ${c?`gc-${c}`:""}`,o.appendChild(a)}),t.appendChild(o)})},w={gridSize:{row:20,col:10},speed:1e3},B=(t,e)=>{if(e<=0)return t;const n=t[0].map((l,o)=>t.map(c=>c[o]).reverse());return B(n,e-1)},v={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[1,1,0],[1,0,0],[1,0,0]],L:[[1,1,0],[0,1,0],[0,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},U=t=>t.map(e=>e.map(n=>n)),f=({grid:t,block:{x:e,y:n,blockCode:l,rotation:o}})=>{const c=v[l],s=U(t);return B(c,o).forEach((S,A)=>{const d=n-A;S.forEach((O,M)=>{var g,h;if(!O)return;const u=e-M,R=u<0,C=u>=((g=s==null?void 0:s[d])==null?void 0:g.length),N=d>=s.length;if(R||C||N)throw new Error("OUT_OF_BOUND");if((h=s==null?void 0:s[d])!=null&&h[u])throw new Error("OVERLAP_VALUE");d>=0&&(s[d][u]=l)})}),s},b=({row:t,col:e})=>new Array(t).fill(0).map(()=>new Array(e).fill(0)),q=()=>{const t=Object.keys(v);return t[Math.floor(Math.random()*t.length)]},G=t=>{const e=t.filter(n=>!n.every(Boolean));return[...b({row:t.length-e.length,col:t[0].length}),...e]},L=()=>({x:6,y:0,rotation:0,blockCode:q()}),P=()=>({grid:b(w.gridSize),currentBlock:L(),clock:void 0,stopped:!0,score:0});let r=P();const i=t=>{try{const e=p(p({},r.currentBlock),t);return f({grid:r.grid,block:e}),r.currentBlock=e,k(),!0}catch{return!1}},k=()=>{const t=document.querySelector("#grid");if(!t)return;const e=f({grid:r.grid,block:r.currentBlock});T(t,e)},z=()=>{if(!i({y:r.currentBlock.y+1})){const e=f({grid:r.grid,block:r.currentBlock});r.grid=G(e),r.currentBlock=L(),k()}},E=()=>{var e;const t=(e=document.querySelector("#stop"))==null?void 0:e.classList;!t||(r.stopped?(clearInterval(r.clock),r.clock=void 0,t.add("active")):(r.clock=setInterval(z,w.speed),t.remove("active")))};window.onload=()=>{k(),E()};document.addEventListener("keydown",t=>{switch(t.key){case"s":r.stopped=!r.stopped,E();break;case"ArrowUp":{if(r.stopped)return;i({rotation:r.currentBlock.rotation+1>3?0:r.currentBlock.rotation+1});break}case"ArrowLeft":{if(r.stopped)return;i({x:r.currentBlock.x-1});break}case"ArrowRight":{if(r.stopped)return;i({x:r.currentBlock.x+1});break}case"ArrowDown":{if(r.stopped)return;i({y:r.currentBlock.y+1});break}case" ":{if(r.stopped)return;let e=!1;for(;!e;)e=!i({y:r.currentBlock.y+1});break}}});
