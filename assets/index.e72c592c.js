var R=Object.defineProperty,N=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var h=(t,e,c)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[e]=c,u=(t,e)=>{for(var c in e||(e={}))G.call(e,c)&&h(t,c,e[c]);if(y)for(var c of y(e))U.call(e,c)&&h(t,c,e[c]);return t},f=(t,e)=>N(t,_(e));const M=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}};M();const T=(t,e)=>{t.innerHTML="",e.forEach((c,l)=>{const o=document.createElement("div");o.className="grid-row",o.id="R"+l,c.forEach((n,i)=>{const a=document.createElement("cell");a.textContent=String(n),a.id="R"+l+"C"+i,a.className=`grid-cell ${n?`gc-${n}`:""}`,o.appendChild(a)}),t.appendChild(o)})},m={gridSize:{row:20,col:10},speed:1e3},B=(t,e)=>{if(e<=0)return t;const c=t[0].map((l,o)=>t.map(n=>n[o]).reverse());return B(c,e-1)},w={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[0,1,0],[0,1,0],[1,1,0]],L:[[1,0,0],[1,0,0],[1,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},C=t=>t.map(e=>e.map(c=>c)),s=({grid:t,block:{x:e,y:c,blockCode:l,rotation:o}})=>{const n=w[l],i=C(t);return B(n,o).forEach((v,L)=>{const d=c-L;if(d>=i.length)throw new Error("OUT_OF_BOUND");d>=0&&v.forEach((O,k)=>{if(!O)return;const S=e-k<0,A=e-k>=i[d].length;if(S||A)throw new Error("OUT_OF_BOUND");const g=e-k;if(i[d][g])throw new Error("OVERLAP_VALUE");i[d][g]=l})}),i},q=({row:t,col:e})=>new Array(t).fill(0).map(()=>new Array(e).fill(0)),x=()=>{const t=Object.keys(w);return t[Math.floor(Math.random()*t.length)]},b=()=>({x:6,y:0,rotation:0,blockCode:x()}),F=()=>({grid:q(m.gridSize),currentBlock:b(),clock:void 0,stopped:!0,score:0});let r=F();const p=()=>{const t=document.querySelector("#grid");if(!t)return;const e=s({grid:r.grid,block:r.currentBlock});T(t,e)},I=()=>{try{const t=r.currentBlock.y+1;s({grid:r.grid,block:f(u({},r.currentBlock),{y:t})}),r.currentBlock.y=t}catch{r.grid=s({grid:r.grid,block:r.currentBlock}),r.currentBlock=b()}finally{r.score=r.score+1,p()}},E=()=>{var e;const t=(e=document.querySelector("#stop"))==null?void 0:e.classList;!t||(r.stopped?(clearInterval(r.clock),r.clock=void 0,t.add("active")):(r.clock=setInterval(I,m.speed),t.remove("active")))};window.onload=()=>{p(),E()};document.addEventListener("keydown",t=>{switch(t.key){case"s":r.stopped=!r.stopped,E();break;case"ArrowUp":{if(r.stopped)return;try{const e=r.currentBlock.rotation+1>3?0:r.currentBlock.rotation+1;s({grid:r.grid,block:f(u({},r.currentBlock),{rotation:e})}),r.currentBlock.rotation=e}catch{}finally{p()}break}case"ArrowLeft":{if(r.stopped)return;try{const e=r.currentBlock.x-1;s({grid:r.grid,block:f(u({},r.currentBlock),{x:e})}),r.currentBlock.x=e}catch{}finally{p()}break}case"ArrowRight":{if(r.stopped)return;try{const e=r.currentBlock.x+1;s({grid:r.grid,block:f(u({},r.currentBlock),{x:e})}),r.currentBlock.x=e}catch{}finally{p()}break}}});
