var R=Object.defineProperty;var h=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var m=(e,t,c)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[t]=c,f=(e,t)=>{for(var c in t||(t={}))_.call(t,c)&&m(e,c,t[c]);if(h)for(var c of h(t))U.call(t,c)&&m(e,c,t[c]);return e};const x=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}};x();const D=(e,t)=>{e.innerHTML="",t.forEach((c,i)=>{const o=document.createElement("div");o.className="grid-row",o.id="R"+i,c.forEach((n,s)=>{const l=document.createElement("cell");l.textContent=String(n),l.id="R"+i+"C"+s,l.className=`grid-cell ${n?`gc-${n}`:""}`,o.appendChild(l)}),e.appendChild(o)})},w={gridSize:{row:20,col:10},speed:1e3},B=(e,t)=>{if(t<=0)return e;const c=e[0].map((i,o)=>e.map(n=>n[o]).reverse());return B(c,t-1)},v={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[0,1,0],[0,1,0],[1,1,0]],L:[[1,0,0],[1,0,0],[1,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},I=e=>e.map(t=>t.map(c=>c)),p=({grid:e,block:{x:t,y:c,blockCode:i,rotation:o}})=>{const n=v[i],s=I(e);return B(n,o).forEach((L,O)=>{const a=c-O;if(a>=s.length)throw new Error("OUT_OF_BOUND");L.forEach((S,A)=>{var g,y;if(!S)return;const u=t-A,M=u<0,N=u>=((g=s==null?void 0:s[a])==null?void 0:g.length);if(M||N)throw new Error("OUT_OF_BOUND");if((y=s==null?void 0:s[a])!=null&&y[u])throw new Error("OVERLAP_VALUE");a>=0&&(s[a][u]=i)})}),s},T=({row:e,col:t})=>new Array(e).fill(0).map(()=>new Array(t).fill(0)),C=()=>{const e=Object.keys(v);return e[Math.floor(Math.random()*e.length)]},b=()=>({x:6,y:0,rotation:0,blockCode:C()}),q=()=>({grid:T(w.gridSize),currentBlock:b(),clock:void 0,stopped:!0,score:0});let r=q();const d=e=>{try{const t=f(f({},r.currentBlock),e);return p({grid:r.grid,block:t}),r.currentBlock=t,k(),!0}catch{return!1}},k=()=>{const e=document.querySelector("#grid");if(!e)return;const t=p({grid:r.grid,block:r.currentBlock});D(e,t)},F=()=>{d({y:r.currentBlock.y+1})||(r.grid=p({grid:r.grid,block:r.currentBlock}),r.currentBlock=b(),k())},E=()=>{var t;const e=(t=document.querySelector("#stop"))==null?void 0:t.classList;!e||(r.stopped?(clearInterval(r.clock),r.clock=void 0,e.add("active")):(r.clock=setInterval(F,w.speed),e.remove("active")))};window.onload=()=>{k(),E()};document.addEventListener("keydown",e=>{switch(e.key){case"s":r.stopped=!r.stopped,E();break;case"ArrowUp":{if(r.stopped)return;d({rotation:r.currentBlock.rotation+1>3?0:r.currentBlock.rotation+1});break}case"ArrowLeft":{if(r.stopped)return;d({x:r.currentBlock.x-1});break}case"ArrowRight":{if(r.stopped)return;d({x:r.currentBlock.x+1});break}case"ArrowDown":{if(r.stopped)return;d({y:r.currentBlock.y+1});break}}});
