var I=Object.defineProperty;var y=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var h=(e,t,o)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,p=(e,t)=>{for(var o in t||(t={}))T.call(t,o)&&h(e,o,t[o]);if(y)for(var o of y(t))_.call(t,o)&&h(e,o,t[o]);return e};const q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}};q();const D=(e,t)=>{e.innerHTML="",t.forEach((o,i)=>{const n=document.createElement("div");n.className="grid-row",n.id="R"+i,o.forEach((c,s)=>{const a=document.createElement("cell");a.textContent=String(c),a.id="R"+i+"C"+s,a.className=`grid-cell ${c?`gc-${c}`:""}`,n.appendChild(a)}),e.appendChild(n)})},w={gridSize:{row:20,col:10},speed:1e3},B=(e,t)=>{if(t<=0)return e;const o=e[0].map((i,n)=>e.map(c=>c[n]).reverse());return B(o,t-1)},v={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[1,1,0],[1,0,0],[1,0,0]],L:[[1,1,0],[0,1,0],[0,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},U=e=>e.map(t=>t.map(o=>o)),f=({grid:e,block:{x:t,y:o,blockCode:i,rotation:n}})=>{const c=v[i],s=U(e);return B(c,n).forEach((A,O)=>{const d=o-O;A.forEach((M,R)=>{var g,m;if(!M)return;const u=t-R,x=u<0,C=u>=((g=s==null?void 0:s[d])==null?void 0:g.length),N=d>=s.length;if(x||C||N)throw new Error("OUT_OF_BOUND");if((m=s==null?void 0:s[d])!=null&&m[u])throw new Error("OVERLAP_VALUE");d>=0&&(s[d][u]=i)})}),s},L=({row:e,col:t})=>new Array(e).fill(0).map(()=>new Array(t).fill(0)),G=()=>{const e=Object.keys(v);return e[Math.floor(Math.random()*e.length)]},P=e=>{const t=e.filter(i=>!i.every(Boolean)),o=e.length-t.length;return{removedLine:o,grid:[...L({row:o,col:e[0].length}),...t]}},b=()=>({x:6,y:0,rotation:0,blockCode:G()}),z=()=>({grid:L(w.gridSize),currentBlock:b(),clock:void 0,stopped:!0,score:0});let r=z();const l=e=>{try{const t=p(p({},r.currentBlock),e);return f({grid:r.grid,block:t}),r.currentBlock=t,k(),!0}catch{return!1}},k=()=>{const e=document.querySelector("#grid");if(!e)return;const t=f({grid:r.grid,block:r.currentBlock});D(e,t)},S=()=>{const e=document.querySelector("#score");!e||(e.innerText=r.score.toString())},F=()=>{if(!l({y:r.currentBlock.y+1})){const t=f({grid:r.grid,block:r.currentBlock}),{grid:o,removedLine:i}=P(t);r.score+=i*100,r.grid=o,r.currentBlock=b(),k()}r.score+=1,S()},E=()=>{var t;const e=(t=document.querySelector("#stop"))==null?void 0:t.classList;!e||(r.stopped?(clearInterval(r.clock),r.clock=void 0,e.add("active")):(r.clock=setInterval(F,w.speed),e.remove("active")))};window.onload=()=>{k(),S(),E()};document.addEventListener("keydown",e=>{switch(e.key){case"s":r.stopped=!r.stopped,E();break;case"ArrowUp":{if(r.stopped)return;l({rotation:r.currentBlock.rotation+1>3?0:r.currentBlock.rotation+1});break}case"ArrowLeft":{if(r.stopped)return;l({x:r.currentBlock.x-1});break}case"ArrowRight":{if(r.stopped)return;l({x:r.currentBlock.x+1});break}case"ArrowDown":{if(r.stopped)return;l({y:r.currentBlock.y+1});break}case" ":{if(r.stopped)return;let t=!1;for(;!t;)t=!l({y:r.currentBlock.y+1});break}}});
