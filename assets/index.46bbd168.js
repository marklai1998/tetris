const b=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function i(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(r){if(r.ep)return;r.ep=!0;const c=i(r);fetch(r.href,c)}};b();const k={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[0,1,0],[0,1,0],[1,1,0]],L:[[1,0,0],[1,0,0],[1,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},p=({blockCode:o,grid:e,y:i,x:n})=>(k[o].forEach((c,l)=>{const s=i-l;if(s>=e.length)throw new Error("OUT_OF_BOUND");s>=0&&c.forEach((y,f)=>{if(!y)return;const h=n-f<0,B=n-f>=e[s].length;if(h||B)throw new Error("OUT_OF_BOUND");const w=n-f;e[s][w]=o})}),e),a=({row:o,col:e})=>new Array(o).fill(0).map(()=>new Array(e).fill(0)),S=()=>{const o=Object.keys(k);return o[Math.floor(Math.random()*o.length)]},G=(o,e)=>e.map((i,n)=>i.map((r,c)=>o[n][c]||r)),d={gridSize:{row:20,col:10},speed:1e3},g=()=>({x:6,y:0,blockCode:S()}),L=()=>({solidGrid:a(d.gridSize),currentGrid:a(d.gridSize),clock:void 0,stopped:!0,score:0,currentBlock:g()});let t=L();const v=o=>{const e=document.querySelector("#grid");!e||(e.innerHTML="",o.forEach((i,n)=>{const r=document.createElement("div");r.className="grid-row",r.id="R"+n,i.forEach((c,l)=>{const s=document.createElement("cell");s.textContent=String(c),s.id="R"+n+"C"+l,s.className=`grid-cell ${c?`gc-${c}`:""}`,r.appendChild(s)}),e.appendChild(r)}))},u=()=>{const o=p({blockCode:t.currentBlock.blockCode,grid:a(d.gridSize),x:t.currentBlock.x,y:t.currentBlock.y}),e=a(d.gridSize).map((i,n)=>i.map((r,c)=>o[n][c]||t.solidGrid[n][c]));t.currentGrid=o,v(e)},E=()=>{var e;t.score=t.score+1,((e=t.currentGrid.at(-1))==null?void 0:e.some(Boolean))&&(t.solidGrid=G(t.currentGrid,t.solidGrid),t.currentBlock=g()),t.currentBlock.y+=1,u()},m=()=>{var e;const o=(e=document.querySelector("#stop"))==null?void 0:e.classList;!o||(t.stopped?(clearInterval(t.clock),t.clock=void 0,o.add("active")):(t.clock=setInterval(E,d.speed),o.remove("active")))};window.onload=()=>{u(),m()};document.addEventListener("keydown",o=>{switch(o.key){case"s":t.stopped=!t.stopped,m();break;case"ArrowLeft":{try{const e=t.currentBlock.x-1;p({blockCode:t.currentBlock.blockCode,grid:a(d.gridSize),x:e,y:t.currentBlock.y}),t.currentBlock.x=e,u()}catch{}break}case"ArrowRight":{try{const e=t.currentBlock.x+1;p({blockCode:t.currentBlock.blockCode,grid:a(d.gridSize),x:e,y:t.currentBlock.y}),t.currentBlock.x=e,u()}catch{}break}}});
