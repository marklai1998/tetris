var x=Object.defineProperty;var h=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var m=(t,e,c)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[e]=c,f=(t,e)=>{for(var c in e||(e={}))I.call(e,c)&&m(t,c,e[c]);if(h)for(var c of h(e))_.call(e,c)&&m(t,c,e[c]);return t};const C=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}};C();const D=(t,e)=>{t.innerHTML="",e.forEach((c,i)=>{const o=document.createElement("div");o.className="grid-row",o.id="R"+i,c.forEach((n,s)=>{const a=document.createElement("cell");a.textContent=String(n),a.id="R"+i+"C"+s,a.className=`grid-cell ${n?`gc-${n}`:""}`,o.appendChild(a)}),t.appendChild(o)})},w={gridSize:{row:20,col:10},speed:1e3},B=(t,e)=>{if(e<=0)return t;const c=t[0].map((i,o)=>t.map(n=>n[o]).reverse());return B(c,e-1)},b={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[1,1,0],[1,0,0],[1,0,0]],L:[[1,1,0],[0,1,0],[0,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},T=t=>t.map(e=>e.map(c=>c)),p=({grid:t,block:{x:e,y:c,blockCode:i,rotation:o}})=>{const n=b[i],s=T(t);return B(n,o).forEach((L,S)=>{const d=c-S;L.forEach((A,O)=>{var g,y;if(!A)return;const u=e-O,M=u<0,R=u>=((g=s==null?void 0:s[d])==null?void 0:g.length),N=d>=s.length;if(M||R||N)throw new Error("OUT_OF_BOUND");if((y=s==null?void 0:s[d])!=null&&y[u])throw new Error("OVERLAP_VALUE");d>=0&&(s[d][u]=i)})}),s},U=({row:t,col:e})=>new Array(t).fill(0).map(()=>new Array(e).fill(0)),q=()=>{const t=Object.keys(b);return t[Math.floor(Math.random()*t.length)]},v=()=>({x:6,y:0,rotation:0,blockCode:q()}),P=()=>({grid:U(w.gridSize),currentBlock:v(),clock:void 0,stopped:!0,score:0});let r=P();const l=t=>{try{const e=f(f({},r.currentBlock),t);return p({grid:r.grid,block:e}),r.currentBlock=e,k(),!0}catch{return!1}},k=()=>{const t=document.querySelector("#grid");if(!t)return;const e=p({grid:r.grid,block:r.currentBlock});D(t,e)},z=()=>{l({y:r.currentBlock.y+1})||(r.grid=p({grid:r.grid,block:r.currentBlock}),r.currentBlock=v(),k())},E=()=>{var e;const t=(e=document.querySelector("#stop"))==null?void 0:e.classList;!t||(r.stopped?(clearInterval(r.clock),r.clock=void 0,t.add("active")):(r.clock=setInterval(z,w.speed),t.remove("active")))};window.onload=()=>{k(),E()};document.addEventListener("keydown",t=>{switch(console.log(t.key),t.key){case"s":r.stopped=!r.stopped,E();break;case"ArrowUp":{if(r.stopped)return;l({rotation:r.currentBlock.rotation+1>3?0:r.currentBlock.rotation+1});break}case"ArrowLeft":{if(r.stopped)return;l({x:r.currentBlock.x-1});break}case"ArrowRight":{if(r.stopped)return;l({x:r.currentBlock.x+1});break}case"ArrowDown":{if(r.stopped)return;l({y:r.currentBlock.y+1});break}case" ":{if(r.stopped)return;let e=!1;for(;!e;)e=!l({y:r.currentBlock.y+1});break}}});
