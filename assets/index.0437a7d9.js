var N=Object.defineProperty,_=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var B=(t,e,c)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[e]=c,a=(t,e)=>{for(var c in e||(e={}))C.call(e,c)&&B(t,c,e[c]);if(m)for(var c of m(e))M.call(e,c)&&B(t,c,e[c]);return t},u=(t,e)=>_(t,U(e));const T=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}};T();const z=(t,e)=>{t.innerHTML="",e.forEach((c,i)=>{const o=document.createElement("div");o.className="grid-row",o.id="R"+i,c.forEach((n,l)=>{const s=document.createElement("cell");s.textContent=String(n),s.id="R"+i+"C"+l,s.className=`grid-cell ${n?`gc-${n}`:""}`,o.appendChild(s)}),t.appendChild(o)})},k={gridSize:{row:20,col:10},speed:1e3},w=(t,e)=>{if(e<=0)return t;const c=t[0].map((i,o)=>t.map(n=>n[o]).reverse());return w(c,e-1)},G={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[0,1,0],[0,1,0],[1,1,0]],L:[[1,0,0],[1,0,0],[1,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},q=t=>t.map(e=>e.map(c=>c)),f=({grid:t,block:{x:e,y:c,blockCode:i,rotation:o}})=>{const n=G[i],l=q(t);return w(n,o).forEach((S,L)=>{const d=c-L;if(d>=l.length)throw new Error("OUT_OF_BOUND");d>=0&&S.forEach((O,g)=>{if(!O)return;const A=e-g<0,R=e-g>=l[d].length;if(A||R)throw new Error("OUT_OF_BOUND");const h=e-g;if(l[d][h])throw new Error("OVERLAP_VALUE");l[d][h]=i})}),l},y=({row:t,col:e})=>new Array(t).fill(0).map(()=>new Array(e).fill(0)),x=()=>{const t=Object.keys(G);return t[Math.floor(Math.random()*t.length)]},b=(t,e)=>e.map((c,i)=>c.map((o,n)=>t[i][n]||o)),E=()=>({x:6,y:0,rotation:0,blockCode:x()}),F=()=>({solidGrid:y(k.gridSize),currentGrid:y(k.gridSize),currentBlock:E(),clock:void 0,stopped:!0,score:0});let r=F();const p=()=>{const t=f({grid:y(k.gridSize),block:r.currentBlock}),e=b(t,r.solidGrid);r.currentGrid=t;const c=document.querySelector("#grid");!c||z(c,e)},I=()=>{try{const t=r.currentBlock.y+1;f({grid:r.solidGrid,block:u(a({},r.currentBlock),{y:t})}),r.currentBlock.y=t}catch{r.solidGrid=b(r.currentGrid,r.solidGrid),r.currentBlock=E()}finally{r.score=r.score+1,p()}},v=()=>{var e;const t=(e=document.querySelector("#stop"))==null?void 0:e.classList;!t||(r.stopped?(clearInterval(r.clock),r.clock=void 0,t.add("active")):(r.clock=setInterval(I,k.speed),t.remove("active")))};window.onload=()=>{p(),v()};document.addEventListener("keydown",t=>{switch(t.key){case"s":r.stopped=!r.stopped,v();break;case"ArrowUp":{if(r.stopped)return;try{const e=r.currentBlock.rotation+1>3?0:r.currentBlock.rotation+1;f({grid:r.solidGrid,block:u(a({},r.currentBlock),{rotation:e})}),r.currentBlock.rotation=e}catch{}finally{p()}break}case"ArrowLeft":{if(r.stopped)return;try{const e=r.currentBlock.x-1;f({grid:r.solidGrid,block:u(a({},r.currentBlock),{x:e})}),r.currentBlock.x=e}catch{}finally{p()}break}case"ArrowRight":{if(r.stopped)return;try{const e=r.currentBlock.x+1;f({grid:r.solidGrid,block:u(a({},r.currentBlock),{x:e})}),r.currentBlock.x=e}catch{}finally{p()}break}}});
