const G=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function i(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(o){if(o.ep)return;o.ep=!0;const c=i(o);fetch(o.href,c)}};G();const m={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[0,1,0],[0,1,0],[1,1,0]],L:[[1,0,0],[1,0,0],[1,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},u=({blockCode:t,grid:r,y:i,x:n,dryRun:o})=>(m[t].forEach((l,s)=>{const d=i-s;if(d>=r.length)throw new Error("OUT_OF_BOUND");d>=0&&l.forEach((B,p)=>{if(!B)return;const w=n-p<0,b=n-p>=r[d].length;if(w||b)throw new Error("OUT_OF_BOUND");const y=n-p;if(r[d][y])throw new Error("OVERLAP_VALUE");o||(r[d][y]=t)})}),r),f=({row:t,col:r})=>new Array(t).fill(0).map(()=>new Array(r).fill(0)),E=()=>{const t=Object.keys(m);return t[Math.floor(Math.random()*t.length)]},S=(t,r)=>r.map((i,n)=>i.map((o,c)=>t[n][c]||o)),a={gridSize:{row:20,col:10},speed:1e3},g=()=>({x:6,y:0,blockCode:E()}),C=()=>({solidGrid:f(a.gridSize),currentGrid:f(a.gridSize),clock:void 0,stopped:!0,score:0,currentBlock:g()});let e=C();const L=t=>{const r=document.querySelector("#grid");!r||(r.innerHTML="",t.forEach((i,n)=>{const o=document.createElement("div");o.className="grid-row",o.id="R"+n,i.forEach((c,l)=>{const s=document.createElement("cell");s.textContent=String(c),s.id="R"+n+"C"+l,s.className=`grid-cell ${c?`gc-${c}`:""}`,o.appendChild(s)}),r.appendChild(o)}))},k=()=>{const t=u({blockCode:e.currentBlock.blockCode,grid:f(a.gridSize),x:e.currentBlock.x,y:e.currentBlock.y}),r=f(a.gridSize).map((i,n)=>i.map((o,c)=>t[n][c]||e.solidGrid[n][c]));e.currentGrid=t,L(r)},O=()=>{try{const t=e.currentBlock.y+1;u({blockCode:e.currentBlock.blockCode,grid:e.solidGrid,x:e.currentBlock.x,y:t,dryRun:!0}),e.currentBlock.y=t}catch{e.solidGrid=S(e.currentGrid,e.solidGrid),e.currentBlock=g()}finally{e.score=e.score+1,k()}},h=()=>{var r;const t=(r=document.querySelector("#stop"))==null?void 0:r.classList;!t||(e.stopped?(clearInterval(e.clock),e.clock=void 0,t.add("active")):(e.clock=setInterval(O,a.speed),t.remove("active")))};window.onload=()=>{k(),h()};document.addEventListener("keydown",t=>{switch(t.key){case"s":e.stopped=!e.stopped,h();break;case"ArrowLeft":{if(e.stopped)return;try{const r=e.currentBlock.x-1;u({blockCode:e.currentBlock.blockCode,grid:e.solidGrid,x:r,y:e.currentBlock.y,dryRun:!0}),e.currentBlock.x=r}catch{}finally{k()}break}case"ArrowRight":{if(e.stopped)return;try{const r=e.currentBlock.x+1;u({blockCode:e.currentBlock.blockCode,grid:e.solidGrid,x:r,y:e.currentBlock.y,dryRun:!0}),e.currentBlock.x=r}catch{}finally{k()}break}}});
