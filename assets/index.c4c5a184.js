var _=Object.defineProperty;var m=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var h=(e,t,o)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,f=(e,t)=>{for(var o in t||(t={}))q.call(t,o)&&h(e,o,t[o]);if(m)for(var o of m(t))D.call(t,o)&&h(e,o,t[o]);return e};const G=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const n of c)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(c){const n={};return c.integrity&&(n.integrity=c.integrity),c.referrerpolicy&&(n.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?n.credentials="include":c.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(c){if(c.ep)return;c.ep=!0;const n=o(c);fetch(c.href,n)}};G();const U=(e,t)=>{e.innerHTML="",t.forEach((o,i)=>{const c=document.createElement("div");c.className="grid-row",c.id="R"+i,o.forEach((n,s)=>{const a=document.createElement("cell");a.textContent=String(n),a.id="R"+i+"C"+s,a.className=`grid-cell ${n?`gc-${n}`:""}`,c.appendChild(a)}),e.appendChild(c)})},w={gridSize:{row:20,col:10},speed:1e3},B=(e,t)=>{if(t<=0)return e;const o=e[0].map((i,c)=>e.map(n=>n[c]).reverse());return B(o,t-1)},v={I:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],J:[[1,1,0],[1,0,0],[1,0,0]],L:[[1,1,0],[0,1,0],[0,1,0]],O:[[1,1],[1,1]],S:[[1,0,0],[1,1,0],[0,1,0]],SR:[[0,1,0],[1,1,0],[1,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]},P=e=>e.map(t=>t.map(o=>o)),p=({grid:e,block:{x:t,y:o,blockCode:i,rotation:c}})=>{const n=v[i],s=P(e);return B(n,c).forEach((I,M)=>{const d=o-M;I.forEach((R,x)=>{var g,y;if(!R)return;const u=t-x,C=u<0,N=u>=((g=s==null?void 0:s[d])==null?void 0:g.length),T=d>=s.length;if(C||N||T)throw new Error("OUT_OF_BOUND");if((y=s==null?void 0:s[d])!=null&&y[u])throw new Error("OVERLAP_VALUE");d>=0&&(s[d][u]=i)})}),s},L=({row:e,col:t})=>new Array(e).fill(0).map(()=>new Array(t).fill(0)),z=()=>{const e=Object.keys(v);return e[Math.floor(Math.random()*e.length)]},F=e=>{const t=e.filter(i=>!i.every(Boolean)),o=e.length-t.length;return{removedLine:o,grid:[...L({row:o,col:e[0].length}),...t]}},b=()=>({x:6,y:0,rotation:0,blockCode:z()}),S=()=>({grid:L(w.gridSize),currentBlock:b(),clock:void 0,stopped:!0,score:0});let r=S();const l=e=>{try{const t=f(f({},r.currentBlock),e);return p({grid:r.grid,block:t}),r.currentBlock=t,k(),!0}catch{return!1}},k=()=>{const e=document.querySelector("#grid");if(!e)return;const t=p({grid:r.grid,block:r.currentBlock});U(e,t)},E=()=>{const e=document.querySelector("#score");!e||(e.innerText=r.score.toString())},A=()=>{clearInterval(r.clock),r=S(),k(),E(),O()},V=()=>{if(l({y:r.currentBlock.y+1}))r.score+=1;else{const t=p({grid:r.grid,block:r.currentBlock}),{grid:o,removedLine:i}=F(t);r.score+=i*100,r.grid=o,l(b())?r.score+=1:A(),k()}E()},O=()=>{var t;const e=(t=document.querySelector("#stop"))==null?void 0:t.classList;!e||(r.stopped?(clearInterval(r.clock),r.clock=void 0,e.add("active")):(r.clock=setInterval(V,w.speed),e.remove("active")))};window.onload=()=>{A()};document.addEventListener("keydown",e=>{switch(e.key){case"s":r.stopped=!r.stopped,O();break;case"ArrowUp":{if(r.stopped)return;l({rotation:r.currentBlock.rotation+1>3?0:r.currentBlock.rotation+1});break}case"ArrowLeft":{if(r.stopped)return;l({x:r.currentBlock.x-1});break}case"ArrowRight":{if(r.stopped)return;l({x:r.currentBlock.x+1});break}case"ArrowDown":{if(r.stopped)return;l({y:r.currentBlock.y+1});break}case" ":{if(r.stopped)return;let t=!1;for(;!t;)t=!l({y:r.currentBlock.y+1});break}}});
